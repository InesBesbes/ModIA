install.packages(c("corrplot", "reshape2", "gridExtra", "tidyverse"))
install.packages(c("glmnet", "coefplot", "ggfortify", "plotly"))
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())   # erase everything, start from scratch!
# load the data from package funFEM
load("velib.RData")
# data preparation
x <- as.matrix(velib$data)
colnames(x) <- 1:ncol(x)
rownames(x) <- velib$names
n <- nrow(x)
stations <- 1:n
coord <- velib$position[stations,]
# select exactly 7 days of data (we remove the first 13 dates)
dates <- 14:181
x <- x[stations, dates]
colnames(x) <- 1:length(dates)
timeTick <- 1 + 24*(0:6)  # vector corresponding to the beginning of days
par(mfrow = c(1, 1))
options(repr.plot.width = 15, repr.plot.height = 6)
plot(x[1, ], col = "blue", type = "l", ylim = c(0, 1),
xlab = "Time", ylab = "Loading", main = rownames(x)[1])
abline(v = timeTick, lty = "dotted")
Xcat <- data.frame(hill = factor(velib$bonus, labels = c("nohill", "hill")))
day <- 7:20
night <- c(1:6, 21:24)
breaks <- c(-0.01, 1/3, 2/3, 1.01)
labels <- letters[1:(length(breaks)-1)]
for (i in 1:7){
newCol <- rowMeans(x[, day + (i-1)*24])
newCol <- cut(newCol, breaks = breaks, labels = labels)
newName <- paste('day', i, sep = '')
Xcat <- cbind(Xcat, newCol)
names(Xcat)[ncol(Xcat)] <- newName
}
for (i in 1:7){
newCol <- rowMeans(x[, night + (i-1)*24])
newCol <- cut(newCol, breaks = breaks, labels = labels)
Xcat <- cbind(Xcat, newCol)
newName <- paste('night', i, sep = '')
names(Xcat)[ncol(Xcat)] <- newName
}
#rownames(Xcat) <- velib$names
head(Xcat)
library(FactoMineR)
afcm <- MCA(Xcat, graph = FALSE)
plot(afcm, axes = c(1, 2), choix = "ind", invisible = "ind", habillage = "quali")
plot(afcm, axes = c(1, 2), choix = "ind", label = "no")
setwd("~/Documents/4ModIA/S1/AnalyseDonnÃ©es")
