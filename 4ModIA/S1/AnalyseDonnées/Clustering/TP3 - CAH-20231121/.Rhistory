daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,....)
hward<-hclust(d, method = "ward.D2")
fviz_dend(hward,show_labels=FALSE)
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,4)
fviz_dend(hward, show_labels=FALSE)
fviz_pca_ind(clustCH)
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE)
fviz_pca_ind()
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind()
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axis = c(1,3))
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axes = c(1,3))
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axes = c(1,3))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(cutree(hward, k=4)), axes = c(1,3))
# A COMPLETER
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(wine[,-c(1,2)], cutree(hward, k)))
}
# A COMPLETER
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(wine[,-c(1,2)], cutree(hward, k)))
}
help(index.S)
# A COMPLETER
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
hward<-hclust(d, method = "ward.D2")
fviz_dend(hward,show_labels=FALSE)
hward$merge
help(hward$merge)
hward$merge
# A COMPLETER
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axes = c(1,3))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(cutree(hward, k=4)), axes = c(1,3))
hward$height
plot(hward$height)
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux1<-data.frame(NbClust=1:Kmax,Intra=rev(hward$height[tail(1:nrow(wine), Kmax)-1]))
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux1<-data.frame(NbClust=1:Kmax,Intra=rev(hward$height[tail(1:nrow(wine), Kmax)-1]))
ggplot(daux1,aes(x=NbClust,y=CH))+geom_line()+geom_point()
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux1<-data.frame(NbClust=2:Kmax,Intra=rev(hward$height[tail(1:nrow(wine), Kmax)-1]))
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux1<-data.frame(NbClust=1:Kmax,Intra=rev(hward$height[tail(1:nrow(wine), Kmax)-1]))
ggplot(daux1,aes(x=NbClust,y=Intra))+geom_line()+geom_point()
aux<-silhouette(ClustCH, daisy(wine[,-c(1,2)]))
fviz_silhouette(aux)+theme(plot.title = element_text(size =9))
rm(df,Silhou,aux)
aux<-silhouette(ClustCH, daisy(wine[,-c(1,2)]))
fviz_silhouette(aux)+theme(plot.title = element_text(size =9))
rm(df,Silhou,aux)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
library(mclust)
library(clusterSim)
library(factoextra)
library(FactoMineR)
library(ggplot2)
library(reshape2)
library(circlize)
library(viridis)
wine<-read.table("wine.txt",header=T)
wine$Qualite = as.factor(wine$Qualite)
wine$Type = factor(wine$Type, labels = c("blanc", "rouge"))
wineinit<-wine
wine[,-c(1,2)]<-scale(wine[,-c(1,2)],center=T,scale=T)
head(wine)
resacp<-PCA(wine,quali.sup=c(1,2), scale.unit = TRUE,graph=FALSE)
fviz_pca_ind(resacp,geom=c("point"),habillage=2)
# A COMPLETER
d = dist(wine[,-c(1,2)], "euclidian")
hclustsingle<-hclust(d, method = "single")
hclustcomplete<-hclust(d, method = "complete")
hclustaverage<-hclust(d, method = "average")
# Dendrogramme
plot(hclustsingle,hang=-1,labels=FALSE)
fviz_dend(hclustsingle,show_labels=FALSE)
plot(hclustcomplete,hang=-1,labels=FALSE)
fviz_dend(hclustcomplete,show_labels=FALSE)
plot(hclustaverage,hang=-1,labels=FALSE)
fviz_dend(hclustaverage,show_labels=FALSE)
ClassK3 = cutree(hclustcomplete,k=3)
table(cutree(hclustcomplete,k=3))
table(cutree(hclustcomplete,k=3), wine$Qualite)
table(cutree(hclustcomplete,k=3), wine$Type)
df<-data.frame(wine[,-c(1,2)],Class=as.factor(ClassK3))
df<-melt(df,id="Class")
ggplot(df,aes(x=variable,y=value))+geom_violin(aes(fill=Class))
hward<-hclust(d, method = "ward.D2")
fviz_dend(hward,show_labels=FALSE)
hward$merge
# A completer
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.G1(wine[,-c(1,2)], cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axes = c(1,3))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(cutree(hward, k=4)), axes = c(1,3))
# A COMPLETER
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux<-data.frame(NbClust=2:Kmax,CH=CH)
ggplot(daux,aes(x=NbClust,y=CH))+geom_line()+geom_point()
ClustCH<-cutree(hward,which.max(CH)+1)
fviz_dend(hward, show_labels=FALSE, k=which.max(CH)+1)
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(ClustCH), axes = c(1,3))
fviz_pca_ind(resacp, geom = c("point"), habillage = as.factor(cutree(hward, k=4)), axes = c(1,3))
CH<-NULL
Kmax<-20
for (k in 2:Kmax){
CH<-c(CH,index.S(d, cutree(hward, k)))
}
daux1<-data.frame(NbClust=1:Kmax,Intra=rev(hward$height[tail(1:nrow(wine), Kmax)-1]))
ggplot(daux1,aes(x=NbClust,y=Intra))+geom_line()+geom_point()
aux<-silhouette(ClustCH, daisy(wine[,-c(1,2)]))
fviz_silhouette(aux)+theme(plot.title = element_text(size =9))
rm(df,Silhou,aux)
clus1F = paste("CKM", reskmeans$cluster, sep="")
clus1F = paste("CKM", cutree(hward, 4), sep="")
mycolor = viridis(0, alpha = 1, begin = 0, end = 1, option = "H")
mycolor = mycolor[sample(1:8)]
chordDiagram(table(clus1F, clus2F), grid.col = mycolor)
clus1F = paste("CKM", reskmeans$cluster, sep="")
clus1F = paste("CAH", cutree(hward, 4), sep="")
mycolor = viridis(0, alpha = 1, begin = 0, end = 1, option = "H")
mycolor = mycolor[sample(1:8)]
chordDiagram(table(clus1F, clus2F), grid.col = mycolor)
zoo<-read.table("zoo-dataTP.txt",header=T,stringsAsFactors = TRUE)
for (j in 1:ncol(zoo))
zoo[,j]<-as.factor(zoo[,j])
summary(zoo)
library("FactoMineR")
library("factoextra")
res.mca<- MCA(zoo,ncp = 5, graph = FALSE)
fviz_screeplot(res.mca)
plot(res.mca, invisible = c("quali.sup", "ind"), cex=1, col.var = "darkblue", cex.main=2, col.main= "darkblue")
fviz_mca_ind(res.mca)
zoo<-read.table("zoo-dataTP.txt",header=T,stringsAsFactors = TRUE)
for (j in 1:ncol(zoo))
zoo[,j]<-as.factor(zoo[,j])
summary(zoo)
library("FactoMineR")
library("factoextra")
res.mca<- MCA(zoo,ncp = 5, graph = FALSE)
fviz_screeplot(res.mca)
plot(res.mca, invisible = c("quali.sup", "ind"), cex=1, col.var = "darkblue", cex.main=2, col.main= "darkblue")
fviz_mca_ind(res.mca)
# J indice des variables
# Data = jeu de données
# clust = clustering étudié
# output : graphe par variable dans J donnant la répartition des modalités de J par classe de clust
barplotClus <- function(clust, Data, J) {
aux.long.p <- heatm(clust, Data, J)$freq
# ux<-unique(aux.long.p$variable)
for (j in J) {
p <- ggplot(aux.long.p[which(aux.long.p$variable == colnames(Data)[j]), ],
aes(x = clust, y = perc, fill = value)) + geom_bar(stat = "identity")+
labs(fill = colnames(Data)[j])
print(p)
}
}
heatm <- function(clust, Data, J) {
library(dplyr)
Dataaux <- data.frame(id.s = c(1:nrow(Data)), Data)
aux <- cbind(Dataaux, clust)
aux.long <- melt(data.frame(lapply(aux, as.character)), stringsAsFactors = FALSE,
id = c("id.s", "clust"), factorsAsStrings = T)
# Effectifs
aux.long.q <- aux.long %>%
group_by(clust, variable, value) %>%
mutate(count = n_distinct(id.s)) %>%
distinct(clust, variable, value, count)
# avec fréquences
aux.long.p <- aux.long.q %>%
group_by(clust, variable) %>%
mutate(perc = count/sum(count)) %>%
arrange(clust)
Lev <- NULL
for (j in 1:ncol(Data)) Lev <- c(Lev, levels(Data[, j]))
Jaux <- NULL
for (j in 1:length(J)) {
Jaux <- c(Jaux, which(aux.long.p$variable == colnames(Data)[J[j]]))
}
gaux <- ggplot(aux.long.p[Jaux, ], aes(x = clust, y = value)) + geom_tile(aes(fill = perc)) +
scale_fill_gradient2(low = "white", mid = "blue", high = "red") + theme_minimal()
return(list(gaux = gaux, eff = aux.long.q, freq = aux.long.p))
}
hclustzoo = hclust(daisy(zoo, metric="euclidian"), method = "complete")
hclustzooS = hclust(daisy(zoo, metric="manhattan"), method = "single")
plot(hclustzooS,hang=-1,labels=FALSE)
fviz_dend(hclustzooS,show_labels=FALSE)
hclustzooC = hclust(daisy(zoo, metric="manhattan"), method = "complete")
plot(hclustzooC,hang=-1,labels=FALSE)
fviz_dend(hclustzooC,show_labels=FALSE)
hclustzooA = hclust(daisy(zoo, metric="manhattan"), method = "average")
plot(hclustzooA,hang=-1,labels=FALSE)
fviz_dend(hclustzooA,show_labels=FALSE)
dzoo = daisy(zoo, metric="gower")
hclustzooS = hclust(dzoo, method = "single")
plot(hclustzooS,hang=-1,labels=FALSE)
fviz_dend(hclustzooS,show_labels=FALSE)
hclustzooC = hclust(dzoo, method = "complete")
plot(hclustzooC,hang=-1,labels=FALSE)
fviz_dend(hclustzooC,show_labels=FALSE)
hclustzooA = hclust(dzoo, method = "average")
plot(hclustzooA,hang=-1,labels=FALSE)
fviz_dend(hclustzooA,show_labels=FALSE)
ggplot(data.frame(K=1:20), Height=sort(aggl$height, decreasing = T), aes(x=K,y=Height)) + geom_line()
ggplot(data.frame(K=1:20), Height=sort(hclustzooC$height, decreasing = T), aes(x=K,y=Height)) + geom_line()
aggl = hclustzooC
ggplot(data.frame(K=1:20), Height=sort(hclustzooC$height, decreasing = T), aes(x=K,y=Height)) + geom_line()
clusaggl = cutree(aggl, 5)
fviz_pca_ind(res.mca, geom.ind = c("point","text"), habillage = as.factor(clusaggl))
aggl = hclustzooC
ggplot(data.frame(K=1:20), Height=sort(hclustzooC$height, decreasing = T), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20), Height=sort(aggl$height, decreasing = T), aes(x=K,y=Height)) + geom_line()+geom_point()
str(zoo)
aggl = hclustzooC
ggplot(data.frame(K=1:20), Height=sort(aggl$height, decreasing = T), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T[1:20]), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T[1:20]), aes(x=K,y=Height))) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T[1:20]), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T[1:20]), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T[1:20])), aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T)[1:20], aes(x=K,y=Height)) + geom_line()+geom_point()
aggl = hclustzooC
ggplot(data.frame(K=1:20, Height=sort(aggl$height, decreasing = T)[1:20]), aes(x=K,y=Height)) + geom_line()+geom_point()
clusaggl = cutree(aggl, 5)
fviz_pca_ind(res.mca, geom.ind = c("point","text"), habillage = as.factor(clusaggl))
table(clusaggl)
clusaggl = cutree(aggl, 9)
fviz_pca_ind(res.mca, geom.ind = c("point","text"), habillage = as.factor(clusaggl))
table(clusaggl)
clustintra = hclustcomplete
table(clustintra, clusaggl)
d = dist(zoo, method = "euclidian")
hclust(d, method = "ward.D2")
clusintra = cutree(hward, k=4)
table(clustintra, clusaggl)
d = dist(res.mca$ind$coord, method = "euclidian")
hclust(d, method = "ward.D2")
clusintra = cutree(hward, k=4)
table(clustintra, clusaggl)
d = dist(res.mca$ind$coord, method = "euclidian")
hward = hclust(d, method = "ward.D2")
clusintra = cutree(hward, k=4)
table(clustintra, clusaggl)
d = dist(res.mca$ind$coord, method = "euclidian")
hward = hclust(d, method = "ward.D2")
clusintra = cutree(hward, k=4)
table(clusintra, clusaggl)
dzoo = daisy(zoo, metric="gower")
hclustzooS = hclust(dzoo, method = "single")
plot(hclustzooS,hang=-1,labels=FALSE)
fviz_dend(hclustzooS,show_labels=FALSE)
hclustzooC = hclust(dzoo, method = "complete")
plot(hclustzooC,hang=-1,labels=FALSE)
fviz_dend(hclustzooC,show_labels=FALSE, k=9)
hclustzooA = hclust(dzoo, method = "average")
plot(hclustzooA,hang=-1,labels=FALSE)
fviz_dend(hclustzooA,show_labels=FALSE)
adjustedRandIndex(clusintra, clusaggl)
