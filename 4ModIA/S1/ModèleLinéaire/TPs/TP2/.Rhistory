install.packages(c("corrplot", "reshape2", "gridExtra", "tidyverse"))
install.packages(c("glmnet", "coefplot", "ggfortify", "plotly"))
knitr::opts_chunk$set(echo = TRUE)
library(FactoMineR)
library(mt)
library(ggplot2)
library(gridExtra)
library(corrplot)
data = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
head(data)
#summary(data)
attributes(data)
str(data)
summary(data)
col_polluant = 4:14
hist(data[, 4], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg)", ylab = "Fréquence")
polluant = log(data[, col_polluant])
hist(polluant[, 1], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg) en échelle log", ylab = "Fréquence")
for (i in 1:11) {
hist(polluant[,i])
}
box<-boxplot(polluant)
res.acp<- PCA(polluant, scale.unit= FALSE)
barplot(res.acp$eig[1:5, "percentage of variance"], main="Pourcentages d'inerties")
boxplot(res.acp$ind$coord)
dataACP <- data.frame(polluant, data$annee_inv, data$TypeEPCI)
res.acp2 <- PCA(dataACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
res.outlier <- pca.outlier(polluant)
res.outlier
outlier<-res.outlier$outlier
cleandata<-data[-c(outlier),]
cleanpolluant = log(cleandata[, col_polluant])
cleanACP <- data.frame(cleanpolluant, cleandata$annee_inv, cleandata$TypeEPCI)
res.acp2 <- PCA(cleanACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
cleanACP <- data.frame(cleanpolluant, cleandata$annee_inv, cleandata$TypeEPCI)
res.acp2 <- PCA(cleanACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
str(polluant)
aovent<-lm(ozone$maxO3~ozone$vent, data = ozone)
str(data)
aovent<-lm(polluant[9]~.^2, data = c(data[c(3,15)], polluant[c(7 ,11)]))
aovent<-lm(polluant[9]~.^2, data = c(data[c(3,15, 10 ,14)]))
aovent<-lm(polluant[9]~.^2, data = c(data[c(3,15, 10 ,14)]))
aovent<-lm(data[12]~.^2, data = c(data[c(3,15, 10 ,14)]))
aovent<-lm(data[12, ]~.^2, data = c(data[c(3,15, 10 ,14)]))
data_trans = rbind(data[-col_polluant], polluant)
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[12]
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[12]
ch4
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[12]
data_trans
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[12]
str(data_trans)
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[34]
str(data_trans)
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[34]
str(data_trans)
ch4
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[34]
str(data_trans)
ch4
#aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[34]
str(data_trans)
ch4
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 10 ,14)]))
data_trans = cbind(data[-col_polluant], polluant)
ch4 = data_trans[34]
str(data_trans)
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 32 ,36)]))
data_trans = cbind(data[1:3], polluant)
ch4 = data_trans[34]
data_trans = cbind(cbind(data[1:3], polluant), data[12:])
data_trans = cbind(cbind(data[1:3], polluant), data[15:])
data_trans = cbind(cbind(data[1:3], polluant), data[16:])
data_trans = cbind(cbind(data[1:3], polluant), data[16:,])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[34]
str(data_trans)
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 32 ,36)]))
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
aovent<-lm(ch4~.^2, data = c(data_trans[c(3,15, 14 ,10)]))
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
aovent<-lm(ch4~.^2, data = data_trans[c(3,15, 14 ,10)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
aovent<-lm(ch4~.^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
ch4
ancova<-lm(ch4~.^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15, 14)]
ancova<-lm(ch4~.^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4~.^2, data = data_trans[c(3, 10, 14, 15, 14)])
knitr::opts_chunk$set(echo = TRUE)
library(FactoMineR)
library(mt)
library(ggplot2)
library(gridExtra)
library(corrplot)
data = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
head(data)
#summary(data)
data$lib_epci = as.factor(data$lib_epci)
data$TypeEPCI = as.factor(data$TypeEPCI)
data$nomdepart = as.factor(data$nomdepart)
data$annee_inv = as.factor(data$annee_inv)
col_polluant = 4:14
hist(data[, 4], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg)", ylab = "Fréquence")
polluant = log(data[, col_polluant])
hist(polluant[, 1], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg) en échelle log", ylab = "Fréquence")
for (i in 1:11) {
hist(polluant[,i])
}
box<-boxplot(polluant)
corrplot(cor(polluant), method="ellipse", tl.cex = 0.7)
res.acp<- PCA(polluant, scale.unit= FALSE)
barplot(res.acp$eig[1:5, "percentage of variance"], main="Pourcentages d'inerties")
boxplot(res.acp$ind$coord)
dataACP <- data.frame(polluant, data$annee_inv, data$TypeEPCI)
res.acp2 <- PCA(dataACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
res.outlier <- pca.outlier(polluant)
res.outlier
outlier<-res.outlier$outlier
cleandata<-data[-c(outlier),]
cleanpolluant = log(cleandata[, col_polluant])
cleanACP <- data.frame(cleanpolluant, cleandata$annee_inv, cleandata$TypeEPCI)
res.acp2 <- PCA(cleanACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4~.^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4~(.)^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4 ~ .^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 14, 15, 14)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 14, 15)])
data_trans = cbind(data[1:3], polluant, data[15:36])
ch4 = data_trans[12]
str(data_trans)
data_trans[c(3, 10, 14, 15)]
ancova<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 12, 14, 15)])
data_trans = cbind(data[1:3], polluant, data[15:36])
anova<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 12, 14, 15)])
anova
data_trans = cbind(data[1:3], polluant, data[15:36])
anova<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 12, 14, 15)])
summary(anova)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(FactoMineR)
library(mt)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(leaps)
library(MASS)
#Bloc qui est compilé mais pas affiché
data = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
head(data)
#summary(data)
attributes(data)
str(data)
data$lib_epci = as.factor(data$lib_epci)
data$TypeEPCI = as.factor(data$TypeEPCI)
data$nomdepart = as.factor(data$nomdepart)
data$annee_inv = as.factor(data$annee_inv)
summary(data)
g1 <- ggplot(data, aes(x = TypeEPCI)) + geom_bar() + ylab("") + ggtitle("Effectifs")
quan <- as.vector(table(data$TypeEPCI))/nrow(data)
df <- data.frame(group = levels(data$TypeEPCI), TypeEPCI = quan)
g2 <- ggplot(df, aes(x = "", y = TypeEPCI, fill = group)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) + theme(legend.position = "bottom")
g23 <- ggplot(data, aes(x = TypeEPCI)) + geom_bar(aes(y = (after_stat(count))/sum(after_stat(count)))) +
ylab("") + ggtitle("Frequences")
grid.arrange(g2,g1,g23, ncol = 3)
col_polluant = 4:14
hist(data[, 4], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg)", ylab = "Fréquence")
polluant = log(data[, col_polluant])
hist(polluant[, 1], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg) en échelle log", ylab = "Fréquence")
box<-boxplot(polluant)
corrplot(cor(polluant), method="ellipse", tl.cex = 0.7)
ggplot(polluant, aes(x = ges_teqco2, y = co2_t)) + geom_point() + geom_smooth(method = lm,
se = FALSE)
g3 <- ggplot(data, aes(x = TypeEPCI, y = log(polluant[,1]))) + ylab("log(nox_kg)") + geom_boxplot()
g4 <- ggplot(data, aes(x = annee_inv, y = log(polluant[,1]))) + ylab("log(nox_kg)") + geom_boxplot()
grid.arrange(g3,g4, ncol = 2)
res.acp<- PCA(polluant, scale.unit= FALSE)
barplot(res.acp$eig[1:5, "percentage of variance"], main="Pourcentages d'inerties")
boxplot(res.acp$ind$coord)
dataACP <- data.frame(polluant, data$annee_inv, data$TypeEPCI)
res.acp2 <- PCA(dataACP, quali.sup = c(12, 13))
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
res.outlier <- pca.outlier(polluant)
res.outlier$plot
outlier<-res.outlier$outlier
cleandata<-data[-c(outlier),]
cleanpolluant = log(cleandata[, col_polluant])
cleanACP <- data.frame(cleanpolluant, cleandata$annee_inv, cleandata$TypeEPCI)
res.acp2 <- PCA(cleanACP, quali.sup = c(12, 13), axes = c(1,2), graph = FALSE)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
plot(res.acp2, axes = c(1,2), choix = "var", cex= 0.5)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
str(data)
data_trans = cbind(data[1:3], polluant, data[15:36])
acpolluant<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 12, 14, 15)])
summary(acpolluant)
ggplot(data_trans,aes(x=nh3_kg,y=ch4_t, shape=annee_inv))+
geom_point()+
geom_smooth(method='lm',se=T)
ggplot(data_trans,aes(x=nh3_kg,y=ch4_t, shape=TypeEPCI))+
geom_point()+
geom_smooth(method='lm',se=T)
stepAIC(acpolluant,trace=F,direction="backward")
stepAIC(acpolluant,trace=F,direction="backward",k=log(nrow(data_trans)))
setwd("~/Documents/4ModIA/S1/Projet_data_stat")
knitr::opts_chunk$set(echo = TRUE)
library(FactoMineR)
library(mt)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(leaflet.providers) #remplace ggmap
```{r setup, include=FALSE, echo=F}
knitr::opts_chunk$set(echo = TRUE)
library(FactoMineR)
library(mt)
library(ggplot2)
library(gridExtra)
library(corrplot)
#library(leaflet.providers) #remplace ggmap
library(leaps)
library(bestglm)
library(MASS)
library(factoextra)
set.seed(1234) #figer l'aléa pour les méthodes comme kmeans
#Bloc qui est compilé mais pas affiché
data = read.csv("Data-projetmodIA-2324.csv", header = TRUE)
data$lib_epci = as.factor(data$lib_epci)
data$TypeEPCI = as.factor(data$TypeEPCI)
data$nomdepart = as.factor(data$nomdepart)
data$annee_inv = as.factor(data$annee_inv)
g1 <- ggplot(data, aes(x = TypeEPCI)) + geom_bar() + ylab("") + ggtitle("Effectifs")
quan <- as.vector(table(data$TypeEPCI))/nrow(data)
df <- data.frame(group = levels(data$TypeEPCI), TypeEPCI = quan)
g2 <- ggplot(df, aes(x = "", y = TypeEPCI, fill = group)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y", start = 0) + theme(legend.position = "bottom")
grid.arrange(g2,g1, ncol = 2)
#objectif : afficher les 2 boxplots cote à cote
col_polluant = 4:14
polluant = log(data[, col_polluant])
boxplot(data[,col_polluant])
boxplot(polluant)
#Tentative d'afficher les 2 boxplots côte à côte
#g1 = ggplot(na.omit(data), aes(x = data[,col_polluant])) + geom_boxplot()
#g2 = ggplot(data, aes(x = log(data[,col_polluant]))) + geom_boxplot()
#grid.arrange(g1,g2,ncol = 2)
#hist(data[, 4], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg)", ylab = "Fréquence")
#hist(polluant[, 1], main = paste("Histogramme de" , "Nox"), xlab = "Quantité de Nox (en Kg) en échelle log", ylab = "Fréquence")
g1 <- ggplot(data, aes(x =data[,4])) + ylab("Effectif") + labs(title = 'Distribution de Nox') + geom_histogram(bins = 39)
g2 <- ggplot(polluant, aes(x =log(polluant[,1]))) + ylab("Effectif") + labs(title = 'Distribution de log(Nox)') +  geom_histogram(bins = 39)
grid.arrange(g1,g2,ncol = 2)
corrplot(cor(polluant), method="ellipse", tl.cex = 0.7)
ggplot(polluant, aes(x = ges_teqco2, y = co2_t)) + geom_point() + geom_smooth(method = lm,
se = FALSE)
g3 <- ggplot(data, aes(x = TypeEPCI, y = log(polluant[,1]))) + ylab("log(nox_kg)") + geom_boxplot()
g4 <- ggplot(data, aes(x = annee_inv, y = log(polluant[,1]))) + ylab("log(nox_kg)") + geom_boxplot()
grid.arrange(g3,g4, ncol = 2)
res.acp<- PCA(polluant, scale.unit= FALSE)
barplot(res.acp$eig[1:5, "percentage of variance"], main="Pourcentages d'inerties")
boxplot(res.acp$ind$coord)
plot(res.acp, )
dataACP <- data.frame(polluant, data$annee_inv, data$TypeEPCI)
res.acp2 <- PCA(dataACP, quali.sup = c(12, 13), graph=FALSE)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
plot(res.acp2, axes = c(1,2), choix = "var", cex= 0.5)
#plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
res.outlier <- pca.outlier(polluant)
res.outlier$plot
outlier<-res.outlier$outlier
cleandata<-data[-c(outlier),]
cleanpolluant = log(cleandata[, col_polluant])
cleanACP <- data.frame(cleanpolluant, cleandata$annee_inv, cleandata$TypeEPCI)
res.acp2 <- PCA(cleanACP, quali.sup = c(12, 13), graph=FALSE)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=13)
plot(res.acp2, axes = c(1,2), choix = "ind", cex= 0.5, label = "quali", habillage=12)
reskmeans<-kmeans(polluant,8)
fviz_cluster(reskmeans,polluant, geom = c('point'))
#tracer boxplot des polluants par classe pour voir si clustering par certaines variables plus que d'autres
#clustering obtenu sur données initiales ou sur acp est il le meme ?
#voir clustering qui se ressemblent pr converger vers une classification il faut donc comparer les clustering entre eux (attention page limitées donc faire le bon choix)
#Avec intéraction
mod1inter <- lm(ges_teqco2~TypeEPCI*annee_inv, data=cleandata)
summary(mod1inter)
#Sans intéraction
mod1 <- lm(ges_teqco2~TypeEPCI + annee_inv, data=cleandata)
summary(mod1)
anova(mod1, mod1inter)
mod11 <- lm(ges_teqco2~TypeEPCI, data=cleandata)
summary(mod11)
anova(mod11, mod1)
mod12 <- lm(ges_teqco2~annee_inv, data=cleandata)
summary(mod12)
anova(mod12, mod1)
mod1intercept <- lm(ges_teqco2~1, data=cleandata)
summary(mod1intercept)
anova(mod1intercept, mod1)
anova(mod11, mod1inter)
stepAIC(mod1inter, direction=c("backward"), trace=T, k=log(nrow(cleandata)))
par(mfrow=c(1,2))
interaction.plot(cleandata[,"TypeEPCI"],cleandata[,"annee_inv"],
cleandata[,"ges_teqco2"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="TypeEPCI",ylab="ges_teqco2",trace.label="annee_inv")
interaction.plot(cleandata[,"annee_inv"],cleandata[,"TypeEPCI"],
cleandata[,"ges_teqco2"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="annee_inv",ylab="ges_teqco2",trace.label="TypeEPCI")
# sans interaction
gespolluant <- lm(ges_teqco2 ~ ., data = polluant)
bestmodel = step(gespolluant, trace = F)
bestmodel2 = step(gespolluant, direction="backward",k=log(nrow(polluant)),trace = F)
library(bestglm)
bestglm(polluant,IC="AIC")
bestglm(polluant,IC="BIC")
#anova à faire pour confirmer le modèle
data_trans = cbind(data[1:3], polluant, data[15:36])
acpolluant<-lm(ch4_t ~ .^2, data = data_trans[c(3, 10, 12, 14, 15)])
summary(acpolluant)
ggplot(data_trans,aes(x=nh3_kg,y=ch4_t, shape=annee_inv))+
geom_point()+
geom_smooth(method='lm',se=T)
stepAIC(acpolluant,trace=F,direction="backward")
stepAIC(acpolluant,trace=F,direction="backward",k=log(nrow(data_trans)))
cleandata<-data[-c(outlier),]
cleanpolluant = log(cleandata[, col_polluant])
new_data = cleandata
cleanpolluant$ch4_t = as.factor(as.numeric((cleanpolluant$ch4_t > log(1000))))
new_data[, col_polluant] = cleanpolluant
MLG_data = new_data[,colnames(new_data)%in% c("ch4_t","nh3_kg","n2o_t","TypeEPCI","annee_inv")]
head(MLG_data)
# 1 == True, 0 == False
summary(MLG_data)
modeldepassement <- glm(ch4_t ~ nh3_kg + n2o_t + TypeEPCI + annee_inv, data = MLG_data, family = binomial("logit"))
summary(modeldepassement)
# ne fonctionne pas
#bestglm(MLG_data,IC = "BIC")
#bestglm(MLG_data,IC="AIC")
bestmodel = step(modeldepassement, trace = F)
bestmodel2 = step(modeldepassement, direction="backward",k=log(nrow(polluant)),trace = F)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
options(max.print=999)
ggplot(ozone,aes(x=maxO3v,y=maxO3, shape=pluie,col=pluie))+
geom_point()+
geom_smooth(method='lm',se=T)
library(knitr)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=FALSE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
class.source="badCode")
opts_knit$set(width=75)
options(max.print=999)
library(ggplot2)
library(dplyr)
library(stringr)
library(tidyselect)
#library(tidyverse)
ozone = read.table("Ozone.txt")
ozone$vent=as.factor(ozone$vent)
ozone$pluie=as.factor(ozone$pluie)
head(ozone)
summary(ozone[,c(1,11,12,13)])
summary(lm(maxO3~vent,data=ozone))
summary(lm(maxO3~C(vent,base=2),data=ozone))
summary(lm(maxO3~C(vent,sum),data=ozone))
table(ozone$vent)
ozonenew = ozone[, c("maxO3", "vent")]
ozonenew = ozonenew %>%
mutate(vent = str_replace(vent, "Nord", "N-O")) %>%
mutate(vent = str_replace(vent, "Ouest", "N-O")) %>%
mutate(vent = str_replace(vent, "Sud", "E-S")) %>%
mutate(vent = str_replace(vent, "Est", "E-S"))
ozonenew$vent = as.factor(ozonenew$vent)
anova(lm(maxO3~vent, data = ozonenew), lm(maxO3~vent, data = ozone))
summary(lm(maxO3~vent, data = ozonenew))
ggplot(ozone,aes(x=vent,y=maxO3,fill=pluie))+
geom_boxplot()
par(mfrow=c(1,2))
interaction.plot(ozone[,"vent"],ozone[,"pluie"],
ozone[,"maxO3"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="vent",ylab="maxO3",trace.label="pluie")
interaction.plot(ozone[,"pluie"],ozone[,"vent"],
ozone[,"maxO3"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="pluie",ylab="maxO3",trace.label="vent")
table(ozone$vent, ozone$pluie)
mod2 = lm(maxO3 ~ vent + pluie, data = ozone)
anova(mod2, mod.int)
anova(lm(maxO3 ~ vent, data = ozone), mod2)
anova(lm(maxO3 ~ pluie, data = ozone), mod2)
anova(mod.int, lm(maxO3 ~ pluie, data = ozone))
ozonenew2 = data.frame(ozonenew, pluie=ozone$pluie)
par(mfrow=c(1,2))
interaction.plot(ozonenew2[,"vent"],ozonenew2[,"pluie"],
ozone[,"maxO3"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="vent",ylab="maxO3",trace.label="pluie")
interaction.plot(ozone[,"pluie"],ozone[,"vent"],
ozone[,"maxO3"],col=c(2,4),pch=c(18,24), main="Interaction plot",type="b",
xlab="pluie",ylab="maxO3",trace.label="vent")
summary(lm(maxO3~vent*pluie, data = ozonenew2))
ggplot(ozone,aes(x=maxO3v,y=maxO3))+
geom_point(aes(shape=pluie,col=pluie))
# version singulière
complet=lm(maxO3~pluie * maxO3v,data=ozone)
summary(complet)
# version régulière
alt=lm(maxO3~-1+pluie+pluie:maxO3v,data=ozone)
summary(alt)
ggplot(ozone,aes(x=maxO3v,y=maxO3, shape=pluie,col=pluie))+
geom_point()+
geom_smooth(method='lm',se=T)
penteu = lm(maxO3~-1+pluie+ maxO3v,data=ozone)
predm1 = predict(penteu)
ggplot(ozone, aes(maxO3v, maxO3, color = pluie)) +
geom_point() +
geom_line(aes(y= predm1))
anova(penteu,complet)
simple = lm(maxO3~maxO3v,data=ozone)
ggplot(ozone,aes(x=maxO3v,y=maxO3))+
geom_point(aes(shape=pluie,col=pluie))+
geom_smooth(method='lm',se=F)
anova(simple,penteu)
```{r}
stepAIC(acpolluant,trace=F,direction="backward")
stepAIC(acpolluant,trace=F,direction="backward",k=log(nrow(data_trans)))
head(data)
#summary(data)
