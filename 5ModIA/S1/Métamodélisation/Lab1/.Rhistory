samples <- mvrnorm(n=5, mu = rep(0,101), Sigma = k2)
?matplot # a function to plot the samples. The samples are indexed by columns
matplot(x=x, y=samples, type="l", lty=1, main="Simulation de 100 échantillons")
k2 = mat5_2Kern(x,x,param)
## simulating some samples using the "mvrnorm" function
samples <- mvrnorm(n=5, mu = rep(0,101), Sigma = k2)
?matplot # a function to plot the samples. The samples are indexed by columns
matplot(x=x, y=samples, type="l", lty=1, main="Simulation de 100 échantillons")
## simulating some samples using the "mvrnorm" function
samples <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
?matplot # a function to plot the samples. The samples are indexed by columns
matplot(x=x, y=samples, type="l", lty=1, main="Simulation de 100 échantillons")
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
samples3 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k3)
?matplot # a function to plot the samples. The samples are indexed by columns
k2 = mat5_2Kern(x,x,param)
k3 = mat3_2Kern(x,x,param)
#### loading some packages and functions ####
library("plot3D")
library("MASS")
source("kernFun.R")
#### Example with the Exp. kernel  ####
x <- seq(0, 1, 0.01) # regular grid
param <- c(1, 0.5) # covariance parameters
k1 <- expKern(x, x, param) # computing the covariance matrix using an exp. kernel
image2D(k1, theta = 0, xlab = "x", ylab = "y") # plotting the covariance matrix
# Q: what can you observe from the covariance matrix?
?mvrnorm # using the help from RStudio
k2 = mat5_2Kern(x,x,param)
k3 = mat3_2Kern(x,x,param)
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
samples3 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k3)
?matplot # a function to plot the samples. The samples are indexed by columns
all_samples <- cbind(samples1, samples2, samples3)
matplot(x = x,
y = all_samples,
type = "l",
lty = 1,
col = c(rep("red", ncol(samples1)),
rep("blue", ncol(samples2)),
rep("green", ncol(samples3))),
main = "Simulation de 300 échantillons",
xlab = "X",
ylab = "Y")
=legend("topright",
matplot(x = x,
y = all_samples,
type = "l",
lty = 1,
col = c(rep("red", ncol(samples1)),
rep("blue", ncol(samples2)),
rep("green", ncol(samples3))),
main = "Simulation de 300 échantillons",
xlab = "X",
ylab = "Y")
matplot(x = x, y = all_samples, type = "l", lty = 1, col = c(rep("red", ncol(samples1)), rep("blue", ncol(samples2)), rep("green", ncol(samples3))),main = "Simulation de 300 échantillons",xlab = "X",ylab = "Y")
?matplot # a function to plot the samples. The samples are indexed by columns
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons")
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
# Définir les couleurs avec transparence
col1 <- adjustcolor("red", alpha.f = 0.3)
col2 <- adjustcolor("blue", alpha.f = 0.3)
col3 <- adjustcolor("green", alpha.f = 0.3)
# Créer le graphique
matplot(x = x,
y = all_samples,
type = "l",
lty = 1,
col = c(rep(col1, ncol(samples1)),
rep(col2, ncol(samples2)),
rep(col3, ncol(samples3))),
main = "Simulation de 300 échantillons avec différents kernels",
xlab = "X",
ylab = "Y")
# Ajouter une légende
legend("topright",
legend = c("Exponential kernel", "Matérn 5/2", "Matérn 3/2"),
col = c(col1, col2, col3),
lty = 1,
cex = 0.8)
# Ajouter du texte explicatif
text(x = min(x), y = max(all_samples),
labels = "Rouge: Exponential\nBleu: Matérn 5/2\nVert: Matérn 3/2",
pos = 4, cex = 0.8)
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
matplot(x=x, y=samples1, type="l", lty=1, col=1, main="Simulation de 100 échantillons pour différents kernels")
matlines(x=x, y=samples2, type="l", lty=1, col=2) # Ajouter la deuxième courbe
matlines(x=x, y=samples3, type="l", lty=1, col=3) # Ajouter la troisième courbe
matlines(x=x, y=samples4, type="l", lty=1, col=4) # Ajouter la quatrième courbe
k3 = mat3_2Kern(x,x,param)
k4 = squared_expKern(x,x,param)
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
#### loading some packages and functions ####
library("plot3D")
library("MASS")
source("kernFun.R")
#### Example with the Exp. kernel  ####
x <- seq(0, 1, 0.01) # regular grid
param <- c(1, 0.5) # covariance parameters
k1 <- expKern(x, x, param) # computing the covariance matrix using an exp. kernel
image2D(k1, theta = 0, xlab = "x", ylab = "y") # plotting the covariance matrix
# Q: what can you observe from the covariance matrix?
?mvrnorm # using the help from RStudio
k2 = mat5_2Kern(x,x,param)
k3 = mat3_2Kern(x,x,param)
k4 = squared_expKern(x,x,param)
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
samples3 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k3)
samples4 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k4)
matplot(x=x, y=samples1, type="l", lty=1, col=1, main="Simulation de 100 échantillons pour différents kernels")
matlines(x=x, y=samples2, type="l", lty=1, col=2) # Ajouter la deuxième courbe
matlines(x=x, y=samples3, type="l", lty=1, col=3) # Ajouter la troisième courbe
matlines(x=x, y=samples4, type="l", lty=1, col=4) # Ajouter la quatrième courbe
# Légende pour distinguer les courbes
legend("topright", legend=c("Exponential kernel", "Matern 5/2", "Matern 3/2", "Squared Exponential"),
col=1:4, lty=1)
matplot(x=x, y=samples1, type="l", lty=1, col=1, main="Simulation de 100 échantillons pour différents kernels")
matlines(x=x, y=samples2, type="l", lty=1) # Ajouter la deuxième courbe
matlines(x=x, y=samples3, type="l", lty=1, col=3) # Ajouter la troisième courbe
matlines(x=x, y=samples4, type="l", lty=1, col=4) # Ajouter la quatrième courbe
# Légende pour distinguer les courbes
legend("topright", legend=c("Exponential kernel", "Matern 5/2", "Matern 3/2", "Squared Exponential"),
col=1:4, lty=1)
matplot(x=x, y=samples1, type="l", lty=1,  main="Simulation de 100 échantillons pour différents kernels")
matlines(x=x, y=samples2, type="l", lty=1) # Ajouter la deuxième courbe
matlines(x=x, y=samples3, type="l", lty=1) # Ajouter la troisième courbe
matlines(x=x, y=samples4, type="l", lty=1) # Ajouter la quatrième courbe
# Légende pour distinguer les courbes
legend("topright", legend=c("Exponential kernel", "Matern 5/2", "Matern 3/2", "Squared Exponential"),
col=1:4, lty=1)
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
samples3 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k3)
samples4 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k4)
par(mfrow=c(2,2))
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
matplot(x=x, y=samples4, type="l", lty=1, main="Simulation de 100 échantillons (squared exponential)")
par(mfrow=c(1,1))
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples4, type="l", lty=1, main="Simulation de 100 échantillons (squared exponential)")
par(mfrow=c(1,1))
par(mfrow=c(2,2))
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples4, type="l", lty=1, main="Simulation de 100 échantillons (squared exponential)")
X = seq(0, 15, 1)
X
X = seq(0, 14, 1)
X
X = seq(0, 1, 1/15)
X = seq(0, 1, 1/15)
X
X = seq(0, 1-1/15, 1/15)
X
X = seq(0, 1-1/15, 1/15)
f <- function(x){
return(x+sin(4*pi*x))
Y = f(X)
}
X = seq(0, 1-1/15, 1/15)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
Y
plot(x,y)
plot(X,Y)
plot(X,Y, type="l")
par(mfrow=c(1,1))
plot(X,Y, type="l")
plot(X,Y, type="l")
plot(X,condMean(X,X,Y,mat5_2Kern, param))
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)*inv(kern(X,X,param)))*Y
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
plot(X,condMean(X,X,Y,mat5_2Kern, param))
library(matlib)
install.packages("matlib")
library(matlib)
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)*inv(kern(X,X,param)))*Y
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
plot(X,condMean(X,X,Y,mat5_2Kern, param))
#plot(X,)
condMean(X,X,Y,mat5_2Kern, param)
plot(condMean(X,X,Y,mat5_2Kern, param))
plot(condMean(X,X,Y,mat5_2Kern, param),  type="l")
condMean(1,X,Y,mat5_2Kern, param)
X
condMean(X,X,Y,mat5_2Kern, param)
plot(X,Y, type="l")
condMean(X,X,Y,mat5_2Kern, param)
plot(condMean(X,X,Y,mat5_2Kern, param))
plot(X, condMean(X,X,Y,mat5_2Kern, param))
plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[0]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1][1]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1:15][1]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1][1:15]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1:15][1]
#plot(X, condMean(X,X,Y,mat5_2Kern, param)[0])
condMean(X,X,Y,mat5_2Kern, param)[1:15,1]
plot(X, condMean(X,X,Y,mat5_2Kern, param)[1:15,1])
plot(X, condMean(X,X,Y,mat5_2Kern, param)[1:15,1], type="l")
x_prime = seq(0, 1, 1/10)
x_prime = seq(0, 1, 1/10)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)*inv(kern(X,X,param)))*Y
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
plot(X, condMean(x_prime,X,Y,mat5_2Kern, param)[1:15,1], type="l")
return(kern(x, X, param)*inv(kern(X,X,param))*Y)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)*inv(kern(X,X,param))*Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
plot(X, condMean(x_prime,X,Y,mat5_2Kern, param)[1:15,1], type="l")
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
plot(X, condMean(x_prime,X,Y,mat5_2Kern, param)[1:15,1], type="l")
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)*inv(kern(X,X,param)) * kern(X,x_prime))
}
plot(X,Y, type="l")
condMean(x_prime,X,Y,mat5_2Kern, param)
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%inv(kern(X,X,param)) %*% kern(X,x_prime, param))
}
plot(X,Y, type="l")
condMean(x_prime,X,Y,mat5_2Kern, param)
condCov(x_prime,x_prime,X,mat5_2Kern, param)
plot(condMean(x_prime,X,Y,mat5_2Kern, param))
plot(X,Y, type="l")
plot(condMean(x_prime,X,Y,mat5_2Kern, param),  type="l")
plot(condCov(x_prime,x_prime,X,mat5_2Kern, param), type="l")
plot(condMean(x_prime,X,Y,mat5_2Kern, param),  type="l")
int_sup = m + 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
int_inf = m - 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
plot(condMean(x_prime,X,Y,mat5_2Kern, param),  type="l")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
int_sup = m + 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
int_inf = m - 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
plot(int_sup)
int_sup = m + 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
int_inf = m - 1.96*sqrt(condCov(x_prime,x_prime,X,mat5_2Kern,param))
plot(int_sup)
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%inv(kern(X,X,param)) %*% kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
main="Deux tracés sur un même graphique",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
# Ajouter le deuxième tracé
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
plot(X,Y, type="l")
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
int_sup = m + 1.96*sqrt(diag(condCov(x_prime,x_prime,X,mat5_2Kern,param)))
int_sup = m + 1.96*sqrt(diag(condCov(x_prime,x_prime,X,mat5_2Kern,param)))
int_inf = m - 1.96*sqrt(diag(condCov(x_prime,x_prime,X,mat5_2Kern,param)))
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
int_inf = m - 1.96*sqrt(diag(cov))
rm(list=ls()) # to clear the environment
#### loading some packages and functions ####
library("plot3D")
library("MASS")
source("kernFun.R")
library(matlib)
#### Example with the Exp. kernel  ####
x <- seq(0, 1, 0.01) # regular grid
param <- c(1, 0.5) # covariance parameters
k1 <- expKern(x, x, param) # computing the covariance matrix using an exp. kernel
image2D(k1, theta = 0, xlab = "x", ylab = "y") # plotting the covariance matrix
# Q: what can you observe from the covariance matrix?
?mvrnorm # using the help from RStudio
k2 = mat5_2Kern(x,x,param)
k3 = mat3_2Kern(x,x,param)
k4 = squared_expKern(x,x,param)
## simulating some samples using the "mvrnorm" function
samples1 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k1)
samples2 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k2)
samples3 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k3)
samples4 <- mvrnorm(n=1, mu = rep(0,101), Sigma = k4)
par(mfrow=c(2,2))
matplot(x=x, y=samples1, type="l", lty=1, main="Simulation de 100 échantillons (exponential kernel)")
matplot(x=x, y=samples3, type="l", lty=1, main="Simulation de 100 échantillons (matern 3/2)")
matplot(x=x, y=samples2, type="l", lty=1, main="Simulation de 100 échantillons (matern 5/2)")
matplot(x=x, y=samples4, type="l", lty=1, main="Simulation de 100 échantillons (squared exponential)")
par(mfrow=c(1,1))
X = seq(0, 1-1/15, 1/15)
x_prime = seq(0, 1, 1/10)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%inv(kern(X,X,param)) %*% kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
int_inf = m - 1.96*sqrt(diag(cov))
X = seq(0, 1, 1/15)
x_prime = seq(0, 1, 1/10)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%inv(kern(X,X,param)) %*% kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
int_inf = m - 1.96*sqrt(diag(cov))
View(cov)
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%solve(kern(X,X,param)) %*% kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
int_inf = m - 1.96*sqrt(diag(cov))
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%solve(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
X = seq(0, 1, 1/15)
x_prime = seq(0, 1, 1/10)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param) - kern(x,X,param)%*%solve(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
diag(cov)
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param)-kern(x,X,param)%*%solve(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
rm(list=ls()) # to clear the environment
rm(list=ls()) # to clear the environment
#### loading some packages and functions ####
library("plot3D")
library("MASS")
source("kernFun.R")
library(matlib)
param <- c(1, 0.5) # covariance parameters
X = seq(0, 1, 1/15)
x_prime = seq(0, 1, 1/10)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param)-kern(x,X,param)%*%solve(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param)-kern(x,X,param)%*%inv(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y, type="l", col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
int_inf = m - 1.96*sqrt(diag(cov))
plot(X, Y,  col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
x_prime = seq(0, 1, 1/100)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param)-kern(x,X,param)%*%inv(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y,  col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
X = seq(0, 1, 1/6)
x_prime = seq(0, 1, 1/100)
f <- function(x){
return(x+sin(4*pi*x))
}
Y = f(X)
condMean <- function(x, X, Y, kern, param) {
return(kern(x, X, param)%*%inv(kern(X,X,param))%*%Y)
}
condCov <- function(x, x_prime, X,  kern, param) {
return(kern(x, x_prime, param)-kern(x,X,param)%*%inv(kern(X,X,param))%*%kern(X,x_prime, param))
}
plot(X, Y,  col="blue",
xlab="X", ylab="Y",
ylim=range(c(Y, condMean(x_prime, X, Y, mat5_2Kern, param))))
lines(x_prime, condMean(x_prime, X, Y, mat5_2Kern, param), col="red")
m = condMean(x_prime,X,Y,mat5_2Kern, param)
cov = condCov(x_prime,x_prime,X,mat5_2Kern,param)
int_sup = m + 1.96*sqrt(diag(cov))
